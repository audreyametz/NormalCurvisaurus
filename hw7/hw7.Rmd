---
title: "hw7"
author: "Hari Rajan"
output: pdf_document
---

## Question 1

```{r}
library(R.matlab)
fmri.p1 <- readMat("data/data-science-P1.mat")
fmri <- do.call(rbind, lapply(fmri.p1$data, unlist))
colnames <- 1:dim(fmri)[2]
```

```{r}
dim(fmri)
fmri[172, 2014]
```

## Question 2

## Question 3

```{r}

# Doing the PCA
fmri.pca = prcomp(fmri)

# Obtaining the loading vectors for each PCA
fmri.latent.sem = fmri.pca$rotation

# To obtain the variances, we first find the standard deviations for all of the principal components. We square them to obtain the variances because variance = sd^2. 
variances = fmri.pca$sdev^2

# To get the fraction of variance for PC1, we divide the variance for PC1 by the sum of variances across all principle components. 
variances[1]/sum(variances)

```

## Question 4

The number of principal components is determined with min(n-1, p). In this case, we need the min of 360-1 and 21764, which is 359. 

## Question 5

A biplot would be very bad because our data is very high dimensional, so we have a lot of principle components. The vectors representing the principal components would overlap each other and we wouldn't be able to tell what's going on around the source of the vectors. 

## Question 6

## Question 7

## Question 8

## Question 9